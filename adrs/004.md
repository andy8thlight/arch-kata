---
id: "0004"
title: Demand Prediction Model
status: proposed
date: 2025-10-22
---


## Context and Problem Statement

MobilityCorp, as a multi-region ride sharing platform, must accurately anticipate **where and when** customers will want to pick up or return vehicles, batteries, or equipment. Effective demand prediction is essential for optimizing **asset distribution**, **fleet utilization**, and **customer satisfaction** across diverse operational environments.

Previous approaches relied on static historical averages, which failed to account for real-time context such as **weather**, **transport strikes**, or **regional events**. As MobilityCorp expands across multiple European countries, the need for a **context-aware, region-specific prediction model** that can continuously learn and adapt has become critical to operational excellence and competitive differentiation.

This ADR builds on the architectural patterns established in ADR-001 (reliability, event-driven integration) and ADR-002 (domain-centric microservices), ensuring that demand prediction is robust, auditable, and seamlessly integrated with downstream operational and financial systems.

---


### Key Questions

- How can we combine real-time contextual signals (weather, strikes, congestion) with historical usage trends?
- How do we handle regional variability in demand patterns?
- Should models be global with regional features, or one per region?
- How are predictions served to routing and concierge systems in real time?
- How can we audit and explain predictions under GDPR Art. 22?

---


## Options

### Option A — Static Statistical Model
Simple regression or moving averages using historical pickups.

**Pros**
- Easy to implement and interpret.  

**Cons**
- Ignores dynamic context; low accuracy in volatile conditions.  

---

### Option B — Centralised ML Model (Single Global)
Single ML model trained on all regions with `region_code` as feature.

**Pros**
- Single model to maintain; shared learnings.  

**Cons**
- May miss regional nuances (e.g., differing transport habits, climate).  

---


### Option C — Regional Context-Aware Models (Recommended)
Train and host **region-specific models** that consume shared features (telemetry, transport, weather, events) from the **Feature Store (ADR-016)**.

**Pros**
- Local accuracy; context-responsive.
- Supports live updates and retraining per region.
- Easily integrated with downstream routing and concierge flows.

**Cons**
- Requires governance and monitoring of multiple models.

---


## Decision

We will adopt **Option C – Regional Context-Aware Models** for demand prediction, leveraging a shared feature pipeline and robust governance. This approach aligns with MobilityCorp’s commitment to operational excellence, regulatory compliance, and architectural consistency across domains.

**Rationale:**
- Region-specific models provide the accuracy and adaptability required for MobilityCorp’s diverse operational footprint, capturing local demand patterns and responding to real-time context.
- Integration with the Feature Store (ADR-016) ensures a unified, high-quality data foundation for all models.
- The event-driven, microservice-aligned serving pattern (batch and on-demand) supports seamless integration with downstream systems (Routing Solver, Concierge Service) and aligns with the reliability and auditability standards set in ADR-001 and ADR-002.
- Model governance, versioning, and auditability are ensured via Model Registry (ADR-015), Immutable Audit Log (ADR-011), and cost controls (ADR-018), supporting explainability and compliance (GDPR Art. 22).
- While this approach introduces complexity in model management and monitoring, the benefits in accuracy, flexibility, and compliance outweigh the trade-offs for a multi-region mobility platform.

Options A and B were rejected because they do not provide sufficient adaptability to local context or real-time operational volatility. Option A (static models) cannot respond to dynamic events, while Option B (single global model) risks missing regional nuances critical for accurate demand prediction and resource allocation.

---


## Consequences

**Positive Consequences:**
- Proactive resource allocation and customer balancing, improving fleet utilization and customer satisfaction.
- Better SLA adherence under variable and volatile conditions (weather, strikes, events).
- Shared data foundation and governance with other AI models, supporting platform-wide consistency and reuse.
- Supports regulatory and audit requirements through versioned, explainable, and tamper-evident model operations.

**Negative Consequences / Trade-offs:**
- Requires multi-region training, monitoring, and governance, increasing operational complexity.
- Needs ongoing feature-store alignment, drift detection, and retraining orchestration.

**Stakeholders:**
- Data Science, Data Engineering, and Platform Engineering teams: responsible for model development, deployment, monitoring, and feature store maintenance.
- Product and Operations teams: define business requirements, validate model outputs, and use predictions for operational planning.
- Compliance and Legal: oversee GDPR and audit requirements.

**Reliability and Integration:**
- All batch and on-demand prediction events must use reliable, idempotent delivery patterns as established in ADR-001 (e.g., Outbox + Worker Queue for Kafka topics and REST endpoints).
- Downstream consumers (Routing Solver, Concierge Service) must be able to handle retries, late or missing predictions, and ensure at-least-once processing semantics.

**Audit and Compliance:**
- All model inputs, outputs, and rationale must be logged to the Immutable Audit Log (ADR-011) and be accessible for compliance review and GDPR explainability requests.
- Regular audits and explainability reviews must be scheduled and owned by the Data Science and Compliance teams.

**Risk Ownership:**
- Data Science and Platform Engineering teams are responsible for monitoring model drift, versioning, and retraining cadence.
- Compliance team is responsible for GDPR and audit-related risks.

**Implementation and Rollout Plan:**
1. Define and document canonical feature schemas in the Feature Store (ADR-016).
2. Develop and validate region-specific model architectures and training pipelines.
3. Establish Outbox + Worker Queue or equivalent reliability patterns for all prediction event delivery.
4. Integrate batch and on-demand serving endpoints with Routing Solver and Concierge Service.
5. Register all models and versions in the Model Registry (ADR-015) and log all inference events to the Audit Log (ADR-011).
6. Schedule regular model audits, drift detection, and compliance reviews.
7. Communicate rollout plan and responsibilities to all stakeholders.

**Follow-ups / Open Issues:**
- Finalize feature schema and data contracts with all consuming services.
- Define SLAs for prediction latency and reliability.
- Establish monitoring dashboards and alerting for model health, drift, and event delivery failures.
- Review and update GDPR explainability documentation in ADR-017 as models evolve.

---


## Implementation Details (High-level)

| Component | Responsibility | Notes |
|---|---|---|
| **Feature Store (ADR-016)** | Provide unified demand features | Real-time and batch |
| **Training Pipeline (Databricks)** | Train per-region models | Uses weather + transport features |
| **Model Registry (ADR-015)** | Store model versions and metadata | EU-region SageMaker registry |
| **Inference Service (AI Interchange, ADR-014)** | Serve live predictions via REST | Region-aware |
| **Kafka Event Bus** | Broadcast batch forecasts | Topic: `demand.predictions` |
| **Routing Solver (ADR-005)** | Consume forecasts for rebalancing | Demand-weighted routing |
| **Concierge Service (ADR-009)** | Personalised recommendations | Demand + user-context fusion |
| **Audit Log (ADR-011)** | Record model inputs, outputs, hashes | Tamper-evident ledger |
| **Observability (ADR-013)** | Monitor model latency and drift | Unified OTel metrics |


**Sequence Example**

<img width="4662" height="1362" alt="004" src="https://github.com/user-attachments/assets/0a980756-8905-4b25-9880-975c7c3ec221" />

---


## Risks and Mitigations

| Risk                               | Likelihood | Impact | Mitigation                                                     |
| ---------------------------------- | ---------: | -----: | -------------------------------------------------------------- |
| Weather or transport feed outages  |        Low |    Med | Cache and interpolate missing data                             |
| Regional drift or bias             |        Med |   High | Per-region retraining and bias checks                          |
| Model version confusion            |        Low |   High | Registry with explicit version tags                            |
| Cost growth from frequent retrains |        Med |    Med | Budget alerts via ADR-018                                      |
| GDPR explainability gaps           |        Med |   High | Store input features and rationale in ADR-017 governance layer |

---


## Alternatives Considered

- **Global model** – rejected for lack of regional sensitivity and inability to capture local demand patterns.
- **Static historical averages** – rejected for poor adaptability to real-time context and operational volatility.
- **Regional contextual models** – chosen for accuracy, flexibility, and alignment with MobilityCorp’s governance and integration standards.


## Related ADRs

- [ADR-001 – External Dependency SLA & Retry Handling](./001.md)
- [ADR-002 – Pricing & Billing Microservice Architecture](./002.md)
- [ADR-005 – Routing Solver (VRP-TW)](./005.md)
- [ADR-007 – Data Platform Architecture](./007.md)
- [ADR-009 – Concierge / Personalisation Service Architecture](./009.md)
- [ADR-011 – Immutable Audit Log Architecture](./011.md)
- [ADR-013 – Observability & Metrics Standardisation](./013.md)
- [ADR-014 – AI Interchange Layer Architecture](./014.md)
- [ADR-015 – Model Hosting & Inference Strategy](./015.md)
- [ADR-016 – AI Data Pipeline & Feature Store Design](./016.md)
- [ADR-017 – AI Governance & Explainability Framework](./017.md)
- [ADR-018 – AI Cost & Budget Guardrails](./018.md)